"use strict";(()=>{var e={};e.id=911,e.ids=[911],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1282:e=>{e.exports=require("child_process")},4770:e=>{e.exports=require("crypto")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},1764:e=>{e.exports=require("util")},1711:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>_,patchFetch:()=>S,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>E,staticGenerationAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{POST:()=>l,dynamic:()=>p});var o=t(3277),i=t(5265),a=t(5356),n=t(7076),c=t(8915),u=t(1570);let p="force-dynamic";async function l(e){try{let r=e.headers.get("authorization"),t=r?.replace("Bearer ","")||e.cookies.get("sb-access-token")?.value;if(!t)return n.NextResponse.json({error:"unauthorized",error_description:"Authentication required"},{status:401});let s=(0,u.createServerClient)(),{data:{user:o},error:i}=await s.auth.getUser(t);if(i||!o)return n.NextResponse.json({error:"unauthorized",error_description:"Invalid session"},{status:401});let{data:a,error:p}=await s.from("users").select("*").eq("id",o.id).single();if(p||!a)return n.NextResponse.json({error:"server_error",error_description:"User not found"},{status:500});let{priceId:l,successUrl:d,cancelUrl:h}=await e.json();if(!l||!d||!h)return n.NextResponse.json({error:"invalid_request",error_description:"Missing required parameters"},{status:400});let m=await (0,c.Mc)({priceId:l,successUrl:d,cancelUrl:h,customerEmail:a.email,metadata:{user_id:a.id,email:a.email}});if(!m)return n.NextResponse.json({error:"server_error",error_description:"Failed to create checkout session"},{status:500});return n.NextResponse.json({sessionId:m.id,url:m.url})}catch(e){return console.error("[Stripe Checkout] Error:",e),n.NextResponse.json({error:"server_error",error_description:e.message||"Internal server error"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/stripe/create-checkout-session/route",pathname:"/api/stripe/create-checkout-session",filename:"route",bundlePath:"app/api/stripe/create-checkout-session/route"},resolvedPagePath:"E:\\Work\\alex\\notion-assistant-alexa-skill\\web-login\\app\\api\\stripe\\create-checkout-session\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:E}=d,_="/api/stripe/create-checkout-session/route";function S(){return(0,a.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:m})}},8915:(e,r,t)=>{t.d(r,{Mc:()=>c,po:()=>n});var s=t(7284);let o=process.env.STRIPE_SECRET_KEY||"",i=process.env.STRIPE_WEBHOOK_SECRET||"";o||console.warn("[Stripe] STRIPE_SECRET_KEY not set. Stripe features will be disabled.");let a=o?new s.Z(o):null;function n(e,r){if(!a||!i)throw Error("Stripe not configured");try{return a.webhooks.constructEvent(e,r,i)}catch(e){return console.error("[Stripe] Webhook signature verification failed:",e.message),null}}async function c(e){if(!a)throw Error("Stripe not configured");try{return await a.checkout.sessions.create({mode:"payment",payment_method_types:["card"],line_items:[{price:e.priceId,quantity:1}],success_url:e.successUrl,cancel_url:e.cancelUrl,customer_email:e.customerEmail,metadata:e.metadata||{}})}catch(e){throw console.error("[Stripe] Error creating checkout session:",e),e}}},1570:(e,r,t)=>{t.d(r,{createServerClient:()=>a});var s=t(2851);let o="https://mwvurelnhrcbtpjtsiyb.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im13dnVyZWxuaHJjYnRwanRzaXliIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2MTE2NjYsImV4cCI6MjA4MDE4NzY2Nn0.4kMmjVKg9V0qUhQQMzxu9CdJuQ-zWpItaaqT3QzAEII";if(!o||!i)throw Error("Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY. For local development, create a .env.local file. For production (Vercel), add them in your project settings.");if(o.includes("supabase.com/dashboard")||o.includes("dashboard/project"))throw Error(`❌ Invalid Supabase URL format!
  
Your NEXT_PUBLIC_SUPABASE_URL is set to: ${o}

This looks like a dashboard URL. It should be the API URL instead.

Correct format: https://[project-ref].supabase.co
Example: https://ptasyynqqlvrbhqmtvhl.supabase.co

To fix:
1. Go to Supabase Dashboard → Settings → API
2. Copy the "Project URL" (not the dashboard URL)
3. Update NEXT_PUBLIC_SUPABASE_URL in Vercel
4. Redeploy your application`);function a(){let e=process.env.SUPABASE_SERVICE_KEY||"",r="https://mwvurelnhrcbtpjtsiyb.supabase.co";if(!e||!r)throw Error("Missing SUPABASE_SERVICE_KEY or NEXT_PUBLIC_SUPABASE_URL");return(0,s.createClient)(r,e,{db:{schema:"public"}})}(0,s.createClient)(o,i,{db:{schema:"public"}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[942,786,851,284],()=>t(1711));module.exports=s})();