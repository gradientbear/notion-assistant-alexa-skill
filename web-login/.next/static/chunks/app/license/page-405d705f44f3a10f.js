(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642],{2133:function(e,t,r){Promise.resolve().then(r.bind(r,9365))},9365:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var s=r(7821),a=r(8078),n=r(8504),i=r(9905);function o(){let e=(0,n.useRouter)(),[t,r]=(0,a.useState)(!0),[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(""),[m,b]=(0,a.useState)(""),[p,f]=(0,a.useState)("");(0,a.useEffect)(()=>{y()},[]);let y=async()=>{try{var t;let{data:{user:s}}=await i.O.auth.getUser();if(!s){e.push("/?mode=signin");return}let a=await fetch("/api/users/me",{headers:{Authorization:"Bearer ".concat(null===(t=(await i.O.auth.getSession()).data.session)||void 0===t?void 0:t.access_token)}});if(!a.ok)throw Error("Failed to fetch user");let n=await a.json();if(d(n),n.license_key){e.push("/dashboard");return}r(!1)}catch(t){console.error("Error checking user:",t),e.push("/?mode=signin")}},g=async t=>{t.preventDefault(),b(""),f(""),l(!0);try{var r,s;if(!u.trim())throw Error("Please enter a license key");let t=await fetch("/api/validate-license",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({licenseKey:u.trim()})});if(!t.ok){let e=await t.json();throw Error(e.error||"Invalid license key")}if(!(await fetch("/api/users/update-license",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===(r=(await i.O.auth.getSession()).data.session)||void 0===r?void 0:r.access_token)},body:JSON.stringify({license_key:u.trim()})})).ok)throw Error("Failed to update license key");f("License key activated successfully!"),await fetch("/api/users/complete-onboarding",{method:"POST",headers:{Authorization:"Bearer ".concat(null===(s=(await i.O.auth.getSession()).data.session)||void 0===s?void 0:s.access_token)}}),setTimeout(()=>{e.push("/dashboard")},2e3)}catch(e){b(e.message||"An error occurred")}finally{l(!1)}};return t?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,s.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Enter License Key"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Enter your license key to activate the Notion Data Alexa skill."}),m&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:m}),p&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm",children:p}),(0,s.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"licenseKey",className:"block text-sm font-medium text-gray-700 mb-1",children:"License Key"}),(0,s.jsx)("input",{id:"licenseKey",type:"text",value:u,onChange:e=>h(e.target.value),required:!0,placeholder:"Enter your license key",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition disabled:bg-gray-100"})]}),(0,s.jsx)("button",{type:"submit",disabled:o,className:"w-full py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 transition disabled:opacity-50",children:o?"Activating...":"Activate License"})]}),(0,s.jsx)("p",{className:"mt-4 text-sm text-gray-500 text-center",children:"Don't have a license key? Contact support to get one."})]})})}},9905:function(e,t,r){"use strict";r.d(t,{O:function(){return i}});var s=r(2616);r(2949);let a="https://ptasyynqqlvrbhqmtvhl.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB0YXN5eW5xcWx2cmJocW10dmhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4NzYwODYsImV4cCI6MjA3OTQ1MjA4Nn0.di3Mk3cndlDzjWwUoXcB8DDslyJO-lbsIHtwRKaWCZI";if(!a||!n)throw console.error("❌ Missing Supabase configuration!"),console.error("Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your environment variables."),Error("Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY. For local development, create a .env.local file. For production (Vercel), add them in your project settings.");if(a.includes("supabase.com/dashboard")||a.includes("dashboard/project")){let e="❌ Invalid Supabase URL format!\n  \nYour NEXT_PUBLIC_SUPABASE_URL is set to: ".concat(a,'\n\nThis looks like a dashboard URL. It should be the API URL instead.\n\nCorrect format: https://[project-ref].supabase.co\nExample: https://ptasyynqqlvrbhqmtvhl.supabase.co\n\nTo fix:\n1. Go to Supabase Dashboard → Settings → API\n2. Copy the "Project URL" (not the dashboard URL)\n3. Update NEXT_PUBLIC_SUPABASE_URL in Vercel\n4. Redeploy your application');throw console.error(e),alert("Configuration Error: Supabase URL is incorrect. Check console for details."),Error(e)}let i=(0,s.createClient)(a,n)}},function(e){e.O(0,[479,115,364,744],function(){return e(e.s=2133)}),_N_E=e.O()}]);